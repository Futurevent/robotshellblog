---
title: Harmony&Fuchsia的相遇
tags:
  - OS
categories:
  - OS
date: 2019-08-16 09:27:29
---

# <center> 一 </center>
2019年8月9日华为正式发布鸿蒙系统，同时表示系统开源。鸿蒙系统的发布是在美国制裁华为的大背景下，华为手机业务极度依赖的android系统极有可能随时断供。在此节点下，自然而然的会让大众理解为是对android断供风险的抵御。但是，时代是进步的。华为重造一个android不过是重嚼别人嚼过的甘蔗，又有何味道呢。华为可是5G的引领者，5G绝非是速度更快的4G，它的领域是万物互联的新一片星辰大海。理所应当的（如果一切不是场战略骗局的话），鸿蒙系统当是这片大海中的一艘远洋巨舰。
<!-- more -->
这么大的一片海，只要不是个瞎子，都是看的见的。做为Android这个航行了十年大船的舵手Google，自然早有预见。2019年6月29日Google悄然上线Fuchsia开发者网站，同时Fuchsia从诞生之时就已开源。
两相印证，鸿蒙和Fuchsia的同时出现并非偶然，也不是单纯的大国较量结果，它有更宏大的背景：人类新时代的到来。简略的说人类经历几次科技革命，从互联网到移动互联网再到即将或正在来临的万物互联网，获取信息的方式跟随连接方式变得的越来越多样。个体是分内外的，否则无所谓个体。所以有连接就有接口，有接口就有交互。OS的作用既是对这多种多样交互的统一。随着万物的逐渐互联，所需的交互方式越来越多，已有的OS已难以继续满足需求。不过像华为、像Google他们想到这个会更早，更深刻，他们在五年前、十年前早已想到并着手开发，所以有了FuchsiaOS，有了鸿蒙OS。他们都是人们交互需求下的正常产物。
# <center> 二 </center>
鸿蒙系统为何物，在近期的各种宣传下，大家多少有些了解了。现搜集整理如下：
- 鸿蒙的发展历程
{% asset_img HarmonyHistory.jpg 鸿蒙的发展历程 %}
- 鸿蒙的架构
{% asset_img HarmonyArch.jpg 鸿蒙的架构框图 %}
逐层的看，应用层表达的是支持多终端；程序框架特意强调了是多用户；基础服务的底层是分布式；内核层当前是多个内核并存。鸿蒙微内核和LiteOS均为华为自主研发，而同时集成Linux内核，不知是当前能力不足无法解决一些问题，还是为更好的兼容当前的android平台应用所做的妥协。至于未来的架构，未来的事情未来再说吧。
- 鸿蒙的四大技术特性
1. __分布式架构首次用于终端OS，实现跨终端无缝协同体验。__ 官方主要解释为实现了模块化接耦，对应不同平台可以弹性部署，实现跨终端无缝的协同体验。从发布会给出的架构图来看，分布式底层依赖分布式软总线，中间对硬件能力进行了虚拟化，使得不同的设备可以像调用自己的设备一样调用系统中其他设备上的硬件，分布式的数据管理可以使不同设备共享同一份用户数据，只是目前不知道到底是如何具体实现的。分布式的任务调度，例如可使得家庭中的各设备可以协同完成同一任务，即提高响应又能够进行全模态的交互。
{% asset_img HarmonySpecDistributed.jpg 特性一：分布式架构%}
2. __确定时延引擎和高性能IPC__，通过对交互进行实时性通道的划分，更好的保证用户交互体验的流畅。同时底层高效的IPC为进程的协作保驾护航（鸿蒙的微内核架构，如果没有很高效率的IPC，又如何敌的过宏内核的linux呢）。值的注意的是，这块特意提到了与Fuchsia（FIDL）的对比，鸿蒙的IPC效率是Fuchsia的5倍。
{% asset_img HarmonySpecDelay.jpg 特性二：确定时延引擎 %}
3. __基于微内核架构重塑终端设备可信安全__, 现在看鸿蒙应该叫多内核环境。至于安全这件事，从来都是要便利买单的。
{% asset_img HarmonySpecKernel.jpg 特性三：微内核多内核 %}
4. __统一IDE支撑开发、多端部署__。
# <center> 三 </center>
Fuchsia 为何物，可能很多人就不太了解了。Fuchsia一直保持着低调和神秘，大家的关注度也不高，其实就连华为也是其重要的代码贡献者。在Fuchsia的开发者网站上，对Fuchsia的描述也只有两行：
```
Pink + Purple == Fuchsia (a new Operating System)

Welcome to Fuchsia! This document has everything you need to get started with Fuchsia.

Note: The Fuchsia source includes Zircon, the core platform that underpins Fuchsia. The Fuchsia build process will build Zircon as a side-effect; to work on Zircon only, read and follow Zircon's Getting Started doc.
```
- Fuchsia 大事记
实在没啥好说的
  - 2016年Google开发者大会发布
  - 2019年6月底上线开发者网站
- Fuchsia 架构
Fuchsia的架构被谷歌形容为层叠蛋糕，大概如下图：
{% asset_img FuchsiaLayer.jpg Fuchsia的层叠蛋糕架构 %}
从下往上，每一层的名字都是一种石头:
第一层是Fuchsia的内核层，该层为Zircon（皓石），类似于linux之于android。负责处理硬件访问和软件之间的通信，与鸿蒙系统的内核一样，Zircon也是微内核的架构（相比宏内核的高效率，微内核由于需要频繁的进程间通信会损耗一部分性能，但是对于分模块开发和提升安全性确是非常重要的优势）
第二层，名叫GarNet（石榴石），包括系统所需的各种底层功能，硬件驱动程序也在这一层，同时这一层也负责软件安装。
第三层，名叫Peridot（橄榄石），这一层主要负责支持Fuchsia的模块化应用程序设计，负责各模块之间的数据同步等，同时这一层也集成了Google Assisant。
第四层，名叫Topaz（黄玉石），是与应用开发者和使用用户关系最紧密的一层，该层可类比为Android中的系统应用层。
- Fuchsia的特点
关于Fuchsia的技术特点，零零碎碎，未找到官方统一的一个说明，有几点简单说明一下
1. 多层蛋糕这种结构，想必是Google从android吸取经验而来，这样分层，可以允许厂商独立替换其中某层，比方，再Peridot这一层有负责各模块数据同步的模块，该模块依赖于Google账号服务，对于国内的设备厂商可以实现自己的数据共享能力，但是同时还可以得到其他层的版本更新支持。
2. 最上层Topaz提供Flutter支持，更方便的接入大量的各种功能的应用
3. Peridot层面向模块设计的应用程序，通过程序内模块的自由组合成用户的story（可理解为用户完成一项任务的各个步骤的集合），从而面向场景化使用，达到系统提供功能的风格一致的复用。这和android系统intent的设计理念高度相似。
4. Peridot使用Google账号服务的模块间数据共享，各模块可能位于不同的终端设备上，又有一些鸿蒙系统分布式的味道。
# <center> 四 </center>
在几乎相同的时间点，华为和Google，分别已鸿蒙系统和Fuchsia系统这两个有众多相似点的系统相遇。它们都面向未来的多种智能设备；微内核的结构都给了设备厂商开发部署各自模块的自由；都在多个设备之间可以无缝的共享数据自由切换；都没有再继续使用linux kernel作为系统的内核；并且都开源了。相遇的这个节点应该不是偶然，这东西方两大巨头的同时到位似乎预示着一个新的交互时代的来临。这次交互时代变革的规模比以往的范围要大的多，他是对万物的连接。
现在是大一统前的黎明，当紧随两艘巨舰的航迹。
